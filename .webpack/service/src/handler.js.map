{"version":3,"sources":["webpack://puppeteer-scraper/./src/handler.ts","webpack://puppeteer-scraper/external \"puppeteer-extra\"","webpack://puppeteer-scraper/external \"puppeteer-extra-plugin-stealth\"","webpack://puppeteer-scraper/webpack/bootstrap","webpack://puppeteer-scraper/webpack/runtime/compat get default export","webpack://puppeteer-scraper/webpack/runtime/define property getters","webpack://puppeteer-scraper/webpack/runtime/hasOwnProperty shorthand","webpack://puppeteer-scraper/webpack/runtime/make namespace object","webpack://puppeteer-scraper/webpack/startup"],"names":["event","puppeteer","StealthPlugin","url","width","height","queryStringParameters","startsWith","statusCode","body","JSON","stringify","massage","browser","page","newPage","setViewport","Number","goto","waitFor","styleSheets","evaluate","scripts","document","getElementsByTagName","Array","from","forEach","script","parentNode","removeChild","css","sheet","rules","cssRules","rule","push","cssText","selectorText","style","innerHTML","join","e","console","log"],"mappings":"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","file":"src/handler.js","sourcesContent":["import puppeteer from 'puppeteer-extra'\nimport StealthPlugin from 'puppeteer-extra-plugin-stealth'\n\nexport default async (event: any) => {\n  puppeteer.use(StealthPlugin())\n  try {\n    const { url = '', width = 1500, height = 900 } = event.queryStringParameters || {}\n\n    if (!url || !url.startsWith('http')) {\n      return {\n        statusCode: 400,\n        body: JSON.stringify({ massage: 'you should specify page URL' }),\n      }\n    }\n\n    const browser = await puppeteer.launch({})\n\n    const page = await browser.newPage()\n    page.setViewport({ width: Number(width), height: Number(height) })\n    await page.goto(url)\n\n    await page.waitFor(3000)\n\n    const [body, styleSheets] = await page.evaluate(() => {\n      const scripts = document.getElementsByTagName('script')\n      Array.from(scripts).forEach((script) => {\n        script?.parentNode?.removeChild(script)\n      })\n\n      const css: string[] = []\n\n      Array.from(document.styleSheets).forEach((sheet) => {\n        // @ts-ignore\n        const rules = 'cssRules' in sheet ? sheet.cssRules : sheet.rules\n        Array.from(rules).forEach((rule: CSSRule) => {\n          if ('cssText' in rule) {\n            css.push(rule.cssText)\n          } else {\n            // @ts-ignore\n            css.push(rule?.selectorText + ' {\\n' + rule?.style?.cssText + '\\n}\\n')\n          }\n        })\n      })\n\n      return [document.body.innerHTML, css.join('\\n')]\n    })\n\n    return {\n      statusCode: 200,\n      body: JSON.stringify({\n        body,\n        styleSheets,\n      }),\n    }\n  } catch (e) {\n    // eslint-disable-next-line\n    console.log(e)\n    return {\n      statusCode: 500,\n      body: JSON.stringify({ massage: 'Something going wrong on backend side' }),\n    }\n  }\n}\n","module.exports = require(\"puppeteer-extra\");","module.exports = require(\"puppeteer-extra-plugin-stealth\");","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tif(__webpack_module_cache__[moduleId]) {\n\t\treturn __webpack_module_cache__[moduleId].exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => module['default'] :\n\t\t() => module;\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => Object.prototype.hasOwnProperty.call(obj, prop)","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","// module exports must be returned from runtime so entry inlining is disabled\n// startup\n// Load entry module and return exports\nreturn __webpack_require__(\"./src/handler.ts\");\n"],"sourceRoot":""}